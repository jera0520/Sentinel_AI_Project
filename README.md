# 🛡️ Sentinel AI Project

공사 현장 안전 모니터링 AI 시스템

## 📋 프로젝트 개요

실시간 영상 분석을 통한 공사장 작업자 안전 모니터링 시스템
- 헬멧 착용 여부 자동 감지
- 작업자 쓰러짐 실시간 탐지
- 원본/업스케일 영상 비교 분석

## 🎯 주요 성과

- **검출 정확도**: 92% (mAP 87%)
- **처리 속도**: 30 FPS (실시간)
- **모델 크기**: 245MB
- **오검출률**: 5% (기존 30% → 25%p 개선)

## 🏗️ 시스템 구성

### 모델
- **YOLOv4** (Darknet): 객체 탐지
- **ByteTrack**: 객체 추적 (Kalman Filter)
- **3개 전문 모델**:
  - person5l: 사람 탐지
  - helmet_resort_v2: 헬멧 분류
  - falldown_v3: 쓰러짐 감지

### 핵심 기술
- **TopDown 2단계 검출**: 환경 배제 후 헬멧 확인
- **스코어링 시스템**: 프레임 누적 판단 (-100~100점)
- **FFmpeg 파이프라인**: 실시간 영상 처리 및 업스케일
- **멀티프로세싱**: 3개 프로세스 병렬 실행

## 📊 데이터

### 수집
- 출처: AI Hub "공사현장 안전장비 인식 이미지"
- 원본: 23,899장

### 재정제
- 최종: 1,000장 (균형 분포)
- 전략: 양보다 **품질과 균형** 우선
- 결과: mAP 45% → 87% (+42%p)

## 🛠️ 개발 환경

- **GPU**: NVIDIA RTX 3060 (12GB)
- **CUDA**: 11.8 + cuDNN 8.9
- **OS**: Ubuntu 22.04 LTS
- **언어**: Python 3.10
- **라이브러리**: OpenCV, FFmpeg, NumPy

## 📁 디렉토리 구조

```
Sentinel_AI_Project/
├── anu_example_3/          # 최종 완성 시스템 ⭐
│   ├── main_scale_v2.py    # 메인 실행 파일
│   ├── model/              # 3개 모델
│   └── videos/             # 테스트 영상
├── darknet/                # YOLOv4 학습 환경
├── *.png                   # PPT용 시각 자료
└── *.md                    # 문서
```

## 🚀 실행 방법

```bash
cd anu_example_3
python3 main_scale_v2.py
```

## 📈 성능 지표

| 항목 | 1차 학습 | 재학습 (최종) | 개선 |
|-----|---------|-------------|-----|
| mAP | 45% | 87% | +42%p |
| 정확도 | 60% | 92% | +32%p |
| 오검출률 | 30% | 5% | -25%p |
| 처리 속도 | 25 FPS | 30 FPS | +5 FPS |

## 💡 핵심 인사이트

> "데이터 양보다 품질과 균형이 더 중요하다"

23,899장 → 1,000장으로 줄였지만, 성능은 2배 향상

## 📚 문서

- `IMPLEMENTATION_SUMMARY.md`: 구현 완료 요약
- `PPT_04_프로젝트_수행_경과.md`: 발표 자료
- `assignment.txt`: 과제 요구사항
- `gemini.md.txt`: 학습 과정 노트

## 🎓 학습 내용

- YOLOv4 커스텀 모델 학습 (8,000 iterations)
- 데이터 품질 개선 (편향 제거)
- TopDown 방식 채택 (오검출 감소)
- 스코어링 시스템 (자원 효율)
- 멀티프로세싱 파이프라인

## 📊 시각 자료

- `data_*.png`: 데이터 분석 그래프
- `slide5_*.png`: 재정제 과정 시각화

## 👥 개발

- 프로젝트: Sentinel AI
- 목표: 공사 현장 안전 모니터링
- 기간: 2024.10

---

**Last Update**: 2024.10.27
